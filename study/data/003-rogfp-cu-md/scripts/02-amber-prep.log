2023-12-05 23:38:13.840-05:00 | INFO     | metalflare.simulation.contexts:run_context_yaml_validator:282 - Validating context from ../../../methods/04-amber-simulations/base.yml
2023-12-05 23:38:13.840-05:00 | INFO     | metalflare.simulation.contexts:from_yaml:151 - Loading YAML context from ../../../methods/04-amber-simulations/base.yml
2023-12-05 23:38:13.841-05:00 | DEBUG    | metalflare.simulation.contexts:from_yaml:155 - YAML data:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:update:166 - Updating context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:update:166 - Updating context:
{}
2023-12-05 23:38:13.842-05:00 | INFO     | metalflare.simulation.contexts:validate:212 - Validating with: AmberContextValidator
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:get:180 - Retrieved context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_dna': None, 'ff_rna': None, 'ff_glycam': None, 'ff_lipid': None, 'ff_small_molecule': None, 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'system_charge': 0, 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'verbosity': None, 'scratch_dir': None, 'compute_platform': 'mpi', 'cpu_cores': None, 'input_kwargs': None, 'stage_name': None, 'stages': None, 'input_dir': None, 'input_path': None, 'output_dir': None, 'output_path': None, 'coord_path': None, 'topo_path': None, 'restart_path': None, 'prev_coordinate_path': None, 'prev_restart_path': None, 'ref_coord_path': None, 'splits': 1, 'sbatch_options': None, 'slurm_lines': None, 'run_path': None, 'slurm_path': None, 'write': False, 'write_dir': None, 'submit': False, 'work_dir': None, 'yaml_path': '../../../methods/04-amber-simulations/base.yml', 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking ff_protein
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:228 -   Valid: ff19SB
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking ff_water
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:228 -   Valid: opc3
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check ff_dna
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check ff_rna
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check ff_glycam
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check ff_lipid
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check ff_small_molecule
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check ff_ions
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check cation_identity
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check anion_identity
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check system_charge
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check neutralize_charge
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking extra_cations
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:235 -   Valid: 0
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking extra_anions
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:235 -   Valid: 0
2023-12-05 23:38:13.842-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check solvent_ionic_strength
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check solvent_padding
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check verbosity
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check scratch_dir
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking compute_platform
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:228 -   Valid: mpi
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check cpu_cores
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking input_kwargs
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:237 -   Skipping: None
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check stage_name
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check stages
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check input_dir
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check input_path
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check output_dir
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check output_path
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check coord_path
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check topo_path
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check restart_path
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check prev_coordinate_path
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check prev_restart_path
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check ref_coord_path
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking splits
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:235 -   Valid: 1
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check sbatch_options
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check slurm_lines
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check run_path
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check slurm_path
2023-12-05 23:38:13.843-05:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking write
2023-12-05 23:38:13.844-05:00 | DEBUG    | metalflare.simulation.contexts:validate:235 -   Valid: False
2023-12-05 23:38:13.844-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check write_dir
2023-12-05 23:38:13.844-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check submit
2023-12-05 23:38:13.844-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check work_dir
2023-12-05 23:38:13.844-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check yaml_path
2023-12-05 23:38:13.844-05:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check add_lines_tleap
2023-12-05 23:38:13.844-05:00 | INFO     | metalflare.simulation.contexts:run_context_yaml_validator:289 - Context IS valid
2023-12-05 23:38:13.947-05:00 | DEBUG    | metalflare.simulation.contexts:update:166 - Updating context:
{}
2023-12-05 23:38:13.947-05:00 | INFO     | metalflare.simulation.contexts:from_yaml:151 - Loading YAML context from ../../../methods/04-amber-simulations/base.yml
2023-12-05 23:38:13.948-05:00 | DEBUG    | metalflare.simulation.contexts:from_yaml:155 - YAML data:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2023-12-05 23:38:13.948-05:00 | DEBUG    | metalflare.simulation.contexts:update:166 - Updating context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2023-12-05 23:38:13.949-05:00 | DEBUG    | metalflare.simulation.contexts:get:180 - Retrieved context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_dna': None, 'ff_rna': None, 'ff_glycam': None, 'ff_lipid': None, 'ff_small_molecule': None, 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'system_charge': 0, 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'verbosity': None, 'scratch_dir': None, 'compute_platform': 'mpi', 'cpu_cores': None, 'input_kwargs': None, 'stage_name': None, 'stages': None, 'input_dir': None, 'input_path': None, 'output_dir': None, 'output_path': None, 'coord_path': None, 'topo_path': None, 'restart_path': None, 'prev_coordinate_path': None, 'prev_restart_path': None, 'ref_coord_path': None, 'splits': 1, 'sbatch_options': None, 'slurm_lines': None, 'run_path': None, 'slurm_path': None, 'write': False, 'write_dir': None, 'submit': False, 'work_dir': '/home/alex/repos/metalflare/study/data/003-rogfp-cu-md/scripts', 'yaml_path': '../../../methods/04-amber-simulations/base.yml', 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2023-12-05 23:38:13.949-05:00 | INFO     | metalflare.simulation.amber.tleap:get_source_ff_lines:64 - Creating tleap commands for loading force fields
2023-12-05 23:38:13.949-05:00 | DEBUG    | metalflare.simulation.contexts:get:180 - Retrieved context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_dna': None, 'ff_rna': None, 'ff_glycam': None, 'ff_lipid': None, 'ff_small_molecule': None, 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'system_charge': 0, 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'verbosity': None, 'scratch_dir': None, 'compute_platform': 'mpi', 'cpu_cores': None, 'input_kwargs': None, 'stage_name': None, 'stages': None, 'input_dir': None, 'input_path': None, 'output_dir': None, 'output_path': None, 'coord_path': None, 'topo_path': None, 'restart_path': None, 'prev_coordinate_path': None, 'prev_restart_path': None, 'ref_coord_path': None, 'splits': 1, 'sbatch_options': None, 'slurm_lines': None, 'run_path': None, 'slurm_path': None, 'write': False, 'write_dir': None, 'submit': False, 'work_dir': '/home/alex/repos/metalflare/study/data/003-rogfp-cu-md/scripts', 'yaml_path': '../../../methods/04-amber-simulations/base.yml', 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2023-12-05 23:38:13.949-05:00 | DEBUG    | metalflare.simulation.amber.tleap:get_prelim_sim_info:207 - Setting PDB output to /tmp/tmprzblspt4.pdb
2023-12-05 23:38:13.949-05:00 | DEBUG    | metalflare.simulation.amber.tleap:get_prelim_sim_info:212 - Writing tleap input to /tmp/tmpgxq2v1ut.in
2023-12-05 23:38:13.949-05:00 | DEBUG    | metalflare.simulation.amber.tleap:get_prelim_sim_info:215 - tleap input:
source leaprc.protein.ff19SB
source leaprc.water.opc3
loadAmberParams frcmod.ionslm_126_opc3
addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} 
{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}
{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }
xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022
loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022
mol = loadpdb ../structures/protein/1JC0-Cu.pdb
solvatebox mol OPC3BOX 10.0
savepdb mol /tmp/tmprzblspt4.pdb
charge mol
quit
2023-12-05 23:38:13.950-05:00 | INFO     | metalflare.simulation.amber.tleap:get_prelim_sim_info:218 - Running tleap
2023-12-05 23:38:13.950-05:00 | DEBUG    | metalflare.simulation.amber.tleap:get_prelim_sim_info:220 - tleap command: ['tleap', '-f', '/tmp/tmpgxq2v1ut.in']
2023-12-05 23:38:14.155-05:00 | DEBUG    | metalflare.simulation.amber.tleap:get_prelim_sim_info:227 - tleap errors:

2023-12-05 23:38:14.156-05:00 | DEBUG    | metalflare.simulation.amber.tleap:get_prelim_sim_info:228 - tleap output:
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/prep to search path.
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib to search path.
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm to search path.
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd to search path.
-f: Source /tmp/tmpgxq2v1ut.in.

Welcome to LEaP!
(no leaprc in search path)
Sourcing: /tmp/tmpgxq2v1ut.in
----- Source: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.protein.ff19SB
----- Source of /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.protein.ff19SB done
Log file: ./leap.log
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/parm19.dat
Reading title:
PARM99 + frcmod.ff99SB + frcmod.parmbsc0 + OL3 for RNA + ff19SB
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.ff19SB
Reading force field modification type file (frcmod)
Reading title:
ff19SB AA-specific backbone CMAPs for protein 07/25/2019
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/amino19.lib
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/aminoct12.lib
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/aminont12.lib
----- Source: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.water.opc3
----- Source of /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.water.opc3 done
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/atomic_ions.lib
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/solvents.lib
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.opc3
Reading force field modification type file (frcmod)
Reading title:
OPC3 Water Model (Izadi and Onufriev,  145, 074501, 2016)
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.ionslm_126_opc3
Reading force field modification type file (frcmod)
Reading title:
Li/Merz ion parameters of atomic ions for the OPC3 water model (12-6 set)
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.ionslm_126_opc3
Reading force field modification type file (frcmod)
Reading title:
Li/Merz ion parameters of atomic ions for the OPC3 water model (12-6 set)
Loading parameters: ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022
Reading force field modification type file (frcmod)
Reading title:
frcmod file for fluorescent protein chromophores. Intended for use with ff14SB, ff19SB and related force fields. Parameters based on parm10.dat, gaff.dat, and frcmod.ff14SB. Publication by Breyfogle, Blood, Rosnik, and Krueger in preparation.
Loading library: ../../../methods/03-tleap/cro/xFPchromophores.lib.2022
Loading PDB file: ../structures/protein/1JC0-Cu.pdb
  total atoms in file: 3569
  Solute vdw bounding box:              39.498 46.751 56.036
  Total bounding box for atom centers:  59.498 66.751 76.036
  Solvent unit box:                     18.682 18.750 18.542
  Total vdw box size:                   63.012 69.435 79.456 angstroms.
  Volume: 347640.826 A^3 
  Total mass 171393.028 amu,  Density 0.819 g/cc
  Added 8086 residues.
Writing pdb file: /tmp/tmprzblspt4.pdb
   printing CRYST1 record to PDB file with box info

/home/alex/miniconda3/envs/metalflare-dev/bin/teLeap: Warning!
 Converting N-terminal residue name to PDB format: NMET -> MET

/home/alex/miniconda3/envs/metalflare-dev/bin/teLeap: Warning!
 Converting C-terminal residue name to PDB format: CGLY -> GLY
Total unperturbed charge:  -8.000000
Total perturbed charge:    -8.000000
	Quit

Exiting LEaP: Errors = 0; Warnings = 2; Notes = 0.

2023-12-05 23:38:14.156-05:00 | INFO     | metalflare.simulation.amber.tleap:parse_tleap_log:116 - Parsing tleap log
2023-12-05 23:38:14.160-05:00 | INFO     | metalflare.simulation.environment:get_ion_counts:26 - Computing number of extra ions
2023-12-05 23:38:14.160-05:00 | DEBUG    | metalflare.simulation.contexts:get:180 - Retrieved context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_dna': None, 'ff_rna': None, 'ff_glycam': None, 'ff_lipid': None, 'ff_small_molecule': None, 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'system_charge': 0, 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'verbosity': None, 'scratch_dir': None, 'compute_platform': 'mpi', 'cpu_cores': None, 'input_kwargs': None, 'stage_name': None, 'stages': None, 'input_dir': None, 'input_path': None, 'output_dir': None, 'output_path': None, 'coord_path': None, 'topo_path': None, 'restart_path': None, 'prev_coordinate_path': None, 'prev_restart_path': None, 'ref_coord_path': None, 'splits': 1, 'sbatch_options': None, 'slurm_lines': None, 'run_path': None, 'slurm_path': None, 'write': False, 'write_dir': None, 'submit': False, 'work_dir': '/home/alex/repos/metalflare/study/data/003-rogfp-cu-md/scripts', 'yaml_path': '../../../methods/04-amber-simulations/base.yml', 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2023-12-05 23:38:14.160-05:00 | DEBUG    | metalflare.simulation.environment:get_ion_counts:29 - Volume of water: 232737.5298621305 A^3
2023-12-05 23:38:14.160-05:00 | DEBUG    | metalflare.simulation.environment:get_ion_counts:41 - Ions to add {'cations': 29, 'anions': 21}
2023-12-05 23:38:14.160-05:00 | DEBUG    | metalflare.simulation.contexts:get:180 - Retrieved context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_dna': None, 'ff_rna': None, 'ff_glycam': None, 'ff_lipid': None, 'ff_small_molecule': None, 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'system_charge': 0, 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'verbosity': None, 'scratch_dir': None, 'compute_platform': 'mpi', 'cpu_cores': None, 'input_kwargs': None, 'stage_name': None, 'stages': None, 'input_dir': None, 'input_path': None, 'output_dir': None, 'output_path': None, 'coord_path': None, 'topo_path': None, 'restart_path': None, 'prev_coordinate_path': None, 'prev_restart_path': None, 'ref_coord_path': None, 'splits': 1, 'sbatch_options': None, 'slurm_lines': None, 'run_path': None, 'slurm_path': None, 'write': False, 'write_dir': None, 'submit': False, 'work_dir': '/home/alex/repos/metalflare/study/data/003-rogfp-cu-md/scripts', 'yaml_path': '../../../methods/04-amber-simulations/base.yml', 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2023-12-05 23:38:14.160-05:00 | INFO     | metalflare.simulation.amber.tleap:get_source_ff_lines:64 - Creating tleap commands for loading force fields
2023-12-05 23:38:14.160-05:00 | DEBUG    | metalflare.simulation.contexts:get:180 - Retrieved context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_dna': None, 'ff_rna': None, 'ff_glycam': None, 'ff_lipid': None, 'ff_small_molecule': None, 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'system_charge': 0, 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'verbosity': None, 'scratch_dir': None, 'compute_platform': 'mpi', 'cpu_cores': None, 'input_kwargs': None, 'stage_name': None, 'stages': None, 'input_dir': None, 'input_path': None, 'output_dir': None, 'output_path': None, 'coord_path': None, 'topo_path': None, 'restart_path': None, 'prev_coordinate_path': None, 'prev_restart_path': None, 'ref_coord_path': None, 'splits': 1, 'sbatch_options': None, 'slurm_lines': None, 'run_path': None, 'slurm_path': None, 'write': False, 'write_dir': None, 'submit': False, 'work_dir': '/home/alex/repos/metalflare/study/data/003-rogfp-cu-md/scripts', 'yaml_path': '../../../methods/04-amber-simulations/base.yml', 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2023-12-05 23:38:14.160-05:00 | DEBUG    | metalflare.simulation.amber.tleap:prepare_amber_files:302 - Setting PDB output to /tmp/tmp0tqsvuon.pdb
2023-12-05 23:38:14.160-05:00 | DEBUG    | metalflare.simulation.amber.tleap:prepare_amber_files:307 - Writing tleap input to /tmp/tmptablq0eu.in
2023-12-05 23:38:14.160-05:00 | DEBUG    | metalflare.simulation.amber.tleap:prepare_amber_files:310 - tleap input:
source leaprc.protein.ff19SB
source leaprc.water.opc3
loadAmberParams frcmod.ionslm_126_opc3
addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} 
{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}
{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }
xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022
loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022
mol = loadpdb ../structures/protein/1JC0-Cu.pdb
addIons2 mol Na+ 29
addIons2 mol Cl- 21
solvatebox mol OPC3BOX 10.0
savepdb mol /tmp/tmp0tqsvuon.pdb
saveamberparm mol ../simulations/02-prep/mol.prmtop ../simulations/02-prep/mol.inpcrd
charge mol
quit
2023-12-05 23:38:14.160-05:00 | INFO     | metalflare.simulation.amber.tleap:prepare_amber_files:313 - Running tleap
2023-12-05 23:38:14.160-05:00 | DEBUG    | metalflare.simulation.amber.tleap:prepare_amber_files:315 - tleap command: ['tleap', '-f', '/tmp/tmptablq0eu.in']
2023-12-05 23:38:16.129-05:00 | DEBUG    | metalflare.simulation.amber.tleap:prepare_amber_files:326 - tleap errors:

2023-12-05 23:38:16.130-05:00 | DEBUG    | metalflare.simulation.amber.tleap:prepare_amber_files:327 - tleap output:
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/prep to search path.
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib to search path.
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm to search path.
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd to search path.
-f: Source /tmp/tmptablq0eu.in.

Welcome to LEaP!
(no leaprc in search path)
Sourcing: /tmp/tmptablq0eu.in
----- Source: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.protein.ff19SB
----- Source of /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.protein.ff19SB done
Log file: ./leap.log
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/parm19.dat
Reading title:
PARM99 + frcmod.ff99SB + frcmod.parmbsc0 + OL3 for RNA + ff19SB
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.ff19SB
Reading force field modification type file (frcmod)
Reading title:
ff19SB AA-specific backbone CMAPs for protein 07/25/2019
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/amino19.lib
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/aminoct12.lib
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/aminont12.lib
----- Source: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.water.opc3
----- Source of /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.water.opc3 done
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/atomic_ions.lib
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/solvents.lib
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.opc3
Reading force field modification type file (frcmod)
Reading title:
OPC3 Water Model (Izadi and Onufriev,  145, 074501, 2016)
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.ionslm_126_opc3
Reading force field modification type file (frcmod)
Reading title:
Li/Merz ion parameters of atomic ions for the OPC3 water model (12-6 set)
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.ionslm_126_opc3
Reading force field modification type file (frcmod)
Reading title:
Li/Merz ion parameters of atomic ions for the OPC3 water model (12-6 set)
Loading parameters: ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022
Reading force field modification type file (frcmod)
Reading title:
frcmod file for fluorescent protein chromophores. Intended for use with ff14SB, ff19SB and related force fields. Parameters based on parm10.dat, gaff.dat, and frcmod.ff14SB. Publication by Breyfogle, Blood, Rosnik, and Krueger in preparation.
Loading library: ../../../methods/03-tleap/cro/xFPchromophores.lib.2022
Loading PDB file: ../structures/protein/1JC0-Cu.pdb
  total atoms in file: 3569
Adding 29 counter ions to "mol" using 1A grid
Grid extends from solute vdw + 1.47  to  7.45
Resolution:      1.00 Angstrom.
Calculating grid charges
Placed Na+ in mol at (28.88, 60.31, 16.93).
Placed Na+ in mol at (17.88, 35.31, 29.93).
Placed Na+ in mol at (45.88, 37.31, 55.93).
Placed Na+ in mol at (44.88, 44.31, 17.93).
Placed Na+ in mol at (18.88, 38.31, 58.93).
Placed Na+ in mol at (33.88, 18.31, 30.93).
Placed Na+ in mol at (24.88, 30.31, 54.93).
Placed Na+ in mol at (22.88, 55.31, 20.93).
Placed Na+ in mol at (15.88, 42.31, 32.93).
Placed Na+ in mol at (46.88, 35.31, 30.93).
Placed Na+ in mol at (26.88, 22.31, 25.93).
Placed Na+ in mol at (36.88, 20.31, 52.93).
Placed Na+ in mol at (21.88, 17.31, 35.93).
Placed Na+ in mol at (29.88, 54.31, 16.93).
Placed Na+ in mol at (24.88, 60.31, 34.93).
Placed Na+ in mol at (37.88, 44.31, 16.93).
Placed Na+ in mol at (47.88, 56.31, 21.93).
Placed Na+ in mol at (31.88, 15.31, 49.93).
Placed Na+ in mol at (49.88, 33.31, 53.93).
Placed Na+ in mol at (22.88, 46.31, 48.93).
Placed Na+ in mol at (38.88, 17.31, 39.93).
Placed Na+ in mol at (47.88, 46.31, 23.93).
Placed Na+ in mol at (16.88, 35.31, 54.93).
Placed Na+ in mol at (19.88, 29.31, 28.93).
Placed Na+ in mol at (41.88, 37.31, 62.93).
Placed Na+ in mol at (38.88, 56.31, 26.93).
Placed Na+ in mol at (33.88, 22.31, 18.93).
Placed Na+ in mol at (25.88, 17.31, 39.93).
Placed Na+ in mol at (40.88, 52.31, 42.93).

Done adding ions.
Adding 21 counter ions to "mol" using 1A grid
Grid extends from solute vdw + 2.31  to  8.29
Resolution:      1.00 Angstrom.
Calculating grid charges
Placed Cl- in mol at (36.04, 41.02, 16.10).
Placed Cl- in mol at (21.04, 28.02, 25.10).
Placed Cl- in mol at (40.04, 34.02, 64.10).
Placed Cl- in mol at (39.04, 59.02, 24.10).
Placed Cl- in mol at (44.04, 54.02, 41.10).
Placed Cl- in mol at (16.04, 39.02, 56.10).
Placed Cl- in mol at (25.04, 15.02, 36.10).
Placed Cl- in mol at (26.04, 49.02, 49.10).
Placed Cl- in mol at (38.04, 18.02, 31.10).
Placed Cl- in mol at (33.04, 26.02, 62.10).
Placed Cl- in mol at (14.04, 44.02, 30.10).
Placed Cl- in mol at (24.04, 58.02, 38.10).
Placed Cl- in mol at (48.04, 35.02, 58.10).
Placed Cl- in mol at (31.04, 21.02, 21.10).
Placed Cl- in mol at (34.04, 46.02, 66.10).
Placed Cl- in mol at (49.04, 58.02, 25.10).
Placed Cl- in mol at (16.04, 32.02, 31.10).
Placed Cl- in mol at (31.04, 52.02, 14.10).
Placed Cl- in mol at (41.04, 14.02, 40.10).
Placed Cl- in mol at (35.04, 52.02, 53.10).
Placed Cl- in mol at (20.04, 31.02, 16.10).

Done adding ions.
  Solute vdw bounding box:              39.703 50.797 57.070
  Total bounding box for atom centers:  59.703 70.797 77.070
  Solvent unit box:                     18.682 18.750 18.542
  Total vdw box size:                   63.012 74.222 80.003 angstroms.
  Volume: 374166.162 A^3 
  Total mass 183829.980 amu,  Density 0.816 g/cc
  Added 8698 residues.
Writing pdb file: /tmp/tmp0tqsvuon.pdb
   printing CRYST1 record to PDB file with box info

/home/alex/miniconda3/envs/metalflare-dev/bin/teLeap: Warning!
 Converting N-terminal residue name to PDB format: NMET -> MET

/home/alex/miniconda3/envs/metalflare-dev/bin/teLeap: Warning!
 Converting C-terminal residue name to PDB format: CGLY -> GLY
Checking Unit.
Building topology.
Building atom parameters.
Building bond parameters.
Building angle parameters.
Building proper torsion parameters.
Building improper torsion parameters.
 total 731 improper torsions applied
Building H-Bond parameters.
Incorporating Non-Bonded adjustments.
Not Marking per-residue atom chain types.
Marking per-residue atom chain types.
  (Residues lacking connect0/connect1 - 
   these don't have chain types marked:

	res	total affected

	CGLY	1
	NMET	1
	WAT	8698
  )
 (no restraints)
Total unperturbed charge:  -0.000000
Total perturbed charge:    -0.000000
	Quit

Exiting LEaP: Errors = 0; Warnings = 2; Notes = 0.

2023-12-05 23:38:16.130-05:00 | INFO     | metalflare.simulation.amber.tleap:parse_tleap_log:116 - Parsing tleap log
