2024-05-21 10:19:34.173-04:00 | INFO     | metalflare.simulation.contexts:run_context_yaml_validator:282 - Validating context from ../../../methods/04-amber-simulations/base.yml
2024-05-21 10:19:34.181-04:00 | INFO     | metalflare.simulation.contexts:from_yaml:151 - Loading YAML context from ../../../methods/04-amber-simulations/base.yml
2024-05-21 10:19:34.182-04:00 | DEBUG    | metalflare.simulation.contexts:from_yaml:155 - YAML data:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2024-05-21 10:19:34.182-04:00 | DEBUG    | metalflare.simulation.contexts:update:166 - Updating context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2024-05-21 10:19:34.182-04:00 | DEBUG    | metalflare.simulation.contexts:update:166 - Updating context:
{}
2024-05-21 10:19:34.182-04:00 | INFO     | metalflare.simulation.contexts:validate:212 - Validating with: AmberContextValidator
2024-05-21 10:19:34.182-04:00 | DEBUG    | metalflare.simulation.contexts:get:180 - Retrieved context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_dna': None, 'ff_rna': None, 'ff_glycam': None, 'ff_lipid': None, 'ff_small_molecule': None, 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'system_charge': 0, 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'verbosity': None, 'scratch_dir': None, 'compute_platform': 'mpi', 'cpu_cores': None, 'input_kwargs': None, 'stage_name': None, 'stages': None, 'input_dir': None, 'input_path': None, 'output_dir': None, 'output_path': None, 'coord_path': None, 'topo_path': None, 'restart_path': None, 'prev_coordinate_path': None, 'prev_restart_path': None, 'ref_coord_path': None, 'splits': 1, 'sbatch_options': None, 'slurm_lines': None, 'run_path': None, 'slurm_path': None, 'write': False, 'write_dir': None, 'submit': False, 'work_dir': None, 'yaml_path': '../../../methods/04-amber-simulations/base.yml', 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2024-05-21 10:19:34.182-04:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking ff_protein
2024-05-21 10:19:34.182-04:00 | DEBUG    | metalflare.simulation.contexts:validate:228 -   Valid: ff19SB
2024-05-21 10:19:34.182-04:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking ff_water
2024-05-21 10:19:34.182-04:00 | DEBUG    | metalflare.simulation.contexts:validate:228 -   Valid: opc3
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check ff_dna
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check ff_rna
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check ff_glycam
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check ff_lipid
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check ff_small_molecule
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check ff_ions
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check cation_identity
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check anion_identity
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check system_charge
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check neutralize_charge
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking extra_cations
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:235 -   Valid: 0
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking extra_anions
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:235 -   Valid: 0
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check solvent_ionic_strength
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check solvent_padding
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check verbosity
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check scratch_dir
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking compute_platform
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:228 -   Valid: mpi
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check cpu_cores
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking input_kwargs
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:237 -   Skipping: None
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check stage_name
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check stages
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check input_dir
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check input_path
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check output_dir
2024-05-21 10:19:34.183-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check output_path
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check coord_path
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check topo_path
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check restart_path
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check prev_coordinate_path
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check prev_restart_path
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check ref_coord_path
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking splits
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:235 -   Valid: 1
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check sbatch_options
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check slurm_lines
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check run_path
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check slurm_path
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:221 - Checking write
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:235 -   Valid: False
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check write_dir
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check submit
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check work_dir
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check yaml_path
2024-05-21 10:19:34.184-04:00 | DEBUG    | metalflare.simulation.contexts:validate:219 - Cannot check add_lines_tleap
2024-05-21 10:19:34.184-04:00 | INFO     | metalflare.simulation.contexts:run_context_yaml_validator:289 - Context IS valid
2024-05-21 10:19:34.723-04:00 | DEBUG    | metalflare.simulation.contexts:update:166 - Updating context:
{}
2024-05-21 10:19:34.723-04:00 | INFO     | metalflare.simulation.contexts:from_yaml:151 - Loading YAML context from ../../../methods/04-amber-simulations/base.yml
2024-05-21 10:19:34.724-04:00 | DEBUG    | metalflare.simulation.contexts:from_yaml:155 - YAML data:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2024-05-21 10:19:34.725-04:00 | DEBUG    | metalflare.simulation.contexts:update:166 - Updating context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2024-05-21 10:19:34.725-04:00 | DEBUG    | metalflare.simulation.contexts:get:180 - Retrieved context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_dna': None, 'ff_rna': None, 'ff_glycam': None, 'ff_lipid': None, 'ff_small_molecule': None, 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'system_charge': 0, 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'verbosity': None, 'scratch_dir': None, 'compute_platform': 'mpi', 'cpu_cores': None, 'input_kwargs': None, 'stage_name': None, 'stages': None, 'input_dir': None, 'input_path': None, 'output_dir': None, 'output_path': None, 'coord_path': None, 'topo_path': None, 'restart_path': None, 'prev_coordinate_path': None, 'prev_restart_path': None, 'ref_coord_path': None, 'splits': 1, 'sbatch_options': None, 'slurm_lines': None, 'run_path': None, 'slurm_path': None, 'write': False, 'write_dir': None, 'submit': False, 'work_dir': '/home/alex/repos/metalflare/study/data/005-rogfp-glu222_h-md/scripts', 'yaml_path': '../../../methods/04-amber-simulations/base.yml', 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2024-05-21 10:19:34.725-04:00 | INFO     | metalflare.simulation.amber.tleap:get_source_ff_lines:64 - Creating tleap commands for loading force fields
2024-05-21 10:19:34.725-04:00 | DEBUG    | metalflare.simulation.contexts:get:180 - Retrieved context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_dna': None, 'ff_rna': None, 'ff_glycam': None, 'ff_lipid': None, 'ff_small_molecule': None, 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'system_charge': 0, 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'verbosity': None, 'scratch_dir': None, 'compute_platform': 'mpi', 'cpu_cores': None, 'input_kwargs': None, 'stage_name': None, 'stages': None, 'input_dir': None, 'input_path': None, 'output_dir': None, 'output_path': None, 'coord_path': None, 'topo_path': None, 'restart_path': None, 'prev_coordinate_path': None, 'prev_restart_path': None, 'ref_coord_path': None, 'splits': 1, 'sbatch_options': None, 'slurm_lines': None, 'run_path': None, 'slurm_path': None, 'write': False, 'write_dir': None, 'submit': False, 'work_dir': '/home/alex/repos/metalflare/study/data/005-rogfp-glu222_h-md/scripts', 'yaml_path': '../../../methods/04-amber-simulations/base.yml', 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2024-05-21 10:19:34.725-04:00 | DEBUG    | metalflare.simulation.amber.tleap:get_prelim_sim_info:207 - Setting PDB output to /tmp/tmp0k0sodfz.pdb
2024-05-21 10:19:34.725-04:00 | DEBUG    | metalflare.simulation.amber.tleap:get_prelim_sim_info:212 - Writing tleap input to /tmp/tmpgh48o1mc.in
2024-05-21 10:19:34.725-04:00 | DEBUG    | metalflare.simulation.amber.tleap:get_prelim_sim_info:215 - tleap input:
source leaprc.protein.ff19SB
source leaprc.water.opc3
loadAmberParams frcmod.ionslm_126_opc3
addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} 
{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}
{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }
xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022
loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022
mol = loadpdb ../structures/protein/1JC0-final.pdb
solvatebox mol OPC3BOX 10.0
savepdb mol /tmp/tmp0k0sodfz.pdb
charge mol
quit
2024-05-21 10:19:34.725-04:00 | INFO     | metalflare.simulation.amber.tleap:get_prelim_sim_info:218 - Running tleap
2024-05-21 10:19:34.725-04:00 | DEBUG    | metalflare.simulation.amber.tleap:get_prelim_sim_info:220 - tleap command: ['tleap', '-f', '/tmp/tmpgh48o1mc.in']
2024-05-21 10:19:34.967-04:00 | DEBUG    | metalflare.simulation.amber.tleap:get_prelim_sim_info:227 - tleap errors:

2024-05-21 10:19:34.967-04:00 | DEBUG    | metalflare.simulation.amber.tleap:get_prelim_sim_info:228 - tleap output:
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/prep to search path.
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib to search path.
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm to search path.
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd to search path.
-f: Source /tmp/tmpgh48o1mc.in.

Welcome to LEaP!
(no leaprc in search path)
Sourcing: /tmp/tmpgh48o1mc.in
----- Source: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.protein.ff19SB
----- Source of /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.protein.ff19SB done
Log file: ./leap.log
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/parm19.dat
Reading title:
PARM99 + frcmod.ff99SB + frcmod.parmbsc0 + OL3 for RNA + ff19SB
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.ff19SB
Reading force field modification type file (frcmod)
Reading title:
ff19SB AA-specific backbone CMAPs for protein 07/25/2019
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/amino19.lib
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/aminoct12.lib
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/aminont12.lib
----- Source: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.water.opc3
----- Source of /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.water.opc3 done
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/atomic_ions.lib
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/solvents.lib
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.opc3
Reading force field modification type file (frcmod)
Reading title:
OPC3 Water Model (Izadi and Onufriev,  145, 074501, 2016)
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.ionslm_126_opc3
Reading force field modification type file (frcmod)
Reading title:
Li/Merz ion parameters of atomic ions for the OPC3 water model (12-6 set)
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.ionslm_126_opc3
Reading force field modification type file (frcmod)
Reading title:
Li/Merz ion parameters of atomic ions for the OPC3 water model (12-6 set)
Loading parameters: ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022
Reading force field modification type file (frcmod)
Reading title:
frcmod file for fluorescent protein chromophores. Intended for use with ff14SB, ff19SB and related force fields. Parameters based on parm10.dat, gaff.dat, and frcmod.ff14SB. Publication by Breyfogle, Blood, Rosnik, and Krueger in preparation.
Loading library: ../../../methods/03-tleap/cro/xFPchromophores.lib.2022
Loading PDB file: ../structures/protein/1JC0-final.pdb
  total atoms in file: 3729
  Leap added 14 missing atoms according to residue templates:
       14 H / lone pairs
  Solute vdw bounding box:              38.275 49.012 56.867
  Total bounding box for atom centers:  58.275 69.012 76.867
  Solvent unit box:                     18.682 18.750 18.542
  Total vdw box size:                   61.498 72.077 79.756 angstroms.
  Volume: 353527.707 A^3 
  Total mass 174861.622 amu,  Density 0.821 g/cc
  Added 8224 residues.
Writing pdb file: /tmp/tmp0k0sodfz.pdb
   printing CRYST1 record to PDB file with box info

/home/alex/miniconda3/envs/metalflare-dev/bin/teLeap: Warning!
 Converting N-terminal residue name to PDB format: NMET -> MET

/home/alex/miniconda3/envs/metalflare-dev/bin/teLeap: Warning!
 Converting C-terminal residue name to PDB format: CGLY -> GLY
Total unperturbed charge:  -8.000000
Total perturbed charge:    -8.000000
	Quit

Exiting LEaP: Errors = 0; Warnings = 2; Notes = 0.

2024-05-21 10:19:34.967-04:00 | INFO     | metalflare.simulation.amber.tleap:parse_tleap_log:116 - Parsing tleap log
2024-05-21 10:19:34.970-04:00 | INFO     | metalflare.simulation.environment:get_ion_counts:26 - Computing number of extra ions
2024-05-21 10:19:34.970-04:00 | DEBUG    | metalflare.simulation.contexts:get:180 - Retrieved context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_dna': None, 'ff_rna': None, 'ff_glycam': None, 'ff_lipid': None, 'ff_small_molecule': None, 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'system_charge': 0, 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'verbosity': None, 'scratch_dir': None, 'compute_platform': 'mpi', 'cpu_cores': None, 'input_kwargs': None, 'stage_name': None, 'stages': None, 'input_dir': None, 'input_path': None, 'output_dir': None, 'output_path': None, 'coord_path': None, 'topo_path': None, 'restart_path': None, 'prev_coordinate_path': None, 'prev_restart_path': None, 'ref_coord_path': None, 'splits': 1, 'sbatch_options': None, 'slurm_lines': None, 'run_path': None, 'slurm_path': None, 'write': False, 'write_dir': None, 'submit': False, 'work_dir': '/home/alex/repos/metalflare/study/data/005-rogfp-glu222_h-md/scripts', 'yaml_path': '../../../methods/04-amber-simulations/base.yml', 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2024-05-21 10:19:34.970-04:00 | DEBUG    | metalflare.simulation.environment:get_ion_counts:29 - Volume of water: 236709.5530034827 A^3
2024-05-21 10:19:34.970-04:00 | DEBUG    | metalflare.simulation.environment:get_ion_counts:41 - Ions to add {'cations': 29, 'anions': 21}
2024-05-21 10:19:34.971-04:00 | DEBUG    | metalflare.simulation.contexts:get:180 - Retrieved context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_dna': None, 'ff_rna': None, 'ff_glycam': None, 'ff_lipid': None, 'ff_small_molecule': None, 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'system_charge': 0, 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'verbosity': None, 'scratch_dir': None, 'compute_platform': 'mpi', 'cpu_cores': None, 'input_kwargs': None, 'stage_name': None, 'stages': None, 'input_dir': None, 'input_path': None, 'output_dir': None, 'output_path': None, 'coord_path': None, 'topo_path': None, 'restart_path': None, 'prev_coordinate_path': None, 'prev_restart_path': None, 'ref_coord_path': None, 'splits': 1, 'sbatch_options': None, 'slurm_lines': None, 'run_path': None, 'slurm_path': None, 'write': False, 'write_dir': None, 'submit': False, 'work_dir': '/home/alex/repos/metalflare/study/data/005-rogfp-glu222_h-md/scripts', 'yaml_path': '../../../methods/04-amber-simulations/base.yml', 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2024-05-21 10:19:34.971-04:00 | INFO     | metalflare.simulation.amber.tleap:get_source_ff_lines:64 - Creating tleap commands for loading force fields
2024-05-21 10:19:34.971-04:00 | DEBUG    | metalflare.simulation.contexts:get:180 - Retrieved context:
{'ff_protein': 'ff19SB', 'ff_water': 'opc3', 'ff_dna': None, 'ff_rna': None, 'ff_glycam': None, 'ff_lipid': None, 'ff_small_molecule': None, 'ff_ions': 'ionslm_126_opc3', 'cation_identity': 'Na+', 'anion_identity': 'Cl-', 'system_charge': 0, 'neutralize_charge': True, 'extra_cations': 0, 'extra_anions': 0, 'solvent_ionic_strength': 0.15, 'solvent_padding': 10.0, 'verbosity': None, 'scratch_dir': None, 'compute_platform': 'mpi', 'cpu_cores': None, 'input_kwargs': None, 'stage_name': None, 'stages': None, 'input_dir': None, 'input_path': None, 'output_dir': None, 'output_path': None, 'coord_path': None, 'topo_path': None, 'restart_path': None, 'prev_coordinate_path': None, 'prev_restart_path': None, 'ref_coord_path': None, 'splits': 1, 'sbatch_options': None, 'slurm_lines': None, 'run_path': None, 'slurm_path': None, 'write': False, 'write_dir': None, 'submit': False, 'work_dir': '/home/alex/repos/metalflare/study/data/005-rogfp-glu222_h-md/scripts', 'yaml_path': '../../../methods/04-amber-simulations/base.yml', 'add_lines_tleap': ['addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} ', '{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}', '{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }', 'xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022', 'loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022']}
2024-05-21 10:19:34.971-04:00 | DEBUG    | metalflare.simulation.amber.tleap:prepare_amber_files:302 - Setting PDB output to /tmp/tmpc1hj2m37.pdb
2024-05-21 10:19:34.971-04:00 | DEBUG    | metalflare.simulation.amber.tleap:prepare_amber_files:307 - Writing tleap input to /tmp/tmpiu2rf2hn.in
2024-05-21 10:19:34.971-04:00 | DEBUG    | metalflare.simulation.amber.tleap:prepare_amber_files:310 - tleap input:
source leaprc.protein.ff19SB
source leaprc.water.opc3
loadAmberParams frcmod.ionslm_126_opc3
addAtomTypes { {"cc" "C" "sp2"} {"cd" "C" "sp2"} {"cf" "C" "sp2"} 
{"c" "C" "sp2"} {"nd" "N" "sp2"} {"nc" "N" "sp2"} {"ne" "N" "sp2"}
{"nf" "N" "sp2"} {"ha" "H" "sp3"} {"oh" "O" "sp3"} }
xFPparams = loadamberparams ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022
loadOff ../../../methods/03-tleap/cro/xFPchromophores.lib.2022
mol = loadpdb ../structures/protein/1JC0-final.pdb
addIons2 mol Na+ 29
addIons2 mol Cl- 21
solvatebox mol OPC3BOX 10.0
savepdb mol /tmp/tmpc1hj2m37.pdb
saveamberparm mol ../simulations/02-prep/mol.prmtop ../simulations/02-prep/mol.inpcrd
charge mol
quit
2024-05-21 10:19:34.971-04:00 | INFO     | metalflare.simulation.amber.tleap:prepare_amber_files:313 - Running tleap
2024-05-21 10:19:34.971-04:00 | DEBUG    | metalflare.simulation.amber.tleap:prepare_amber_files:315 - tleap command: ['tleap', '-f', '/tmp/tmpiu2rf2hn.in']
2024-05-21 10:19:37.975-04:00 | DEBUG    | metalflare.simulation.amber.tleap:prepare_amber_files:326 - tleap errors:

2024-05-21 10:19:37.975-04:00 | DEBUG    | metalflare.simulation.amber.tleap:prepare_amber_files:327 - tleap output:
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/prep to search path.
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib to search path.
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm to search path.
-I: Adding /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd to search path.
-f: Source /tmp/tmpiu2rf2hn.in.

Welcome to LEaP!
(no leaprc in search path)
Sourcing: /tmp/tmpiu2rf2hn.in
----- Source: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.protein.ff19SB
----- Source of /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.protein.ff19SB done
Log file: ./leap.log
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/parm19.dat
Reading title:
PARM99 + frcmod.ff99SB + frcmod.parmbsc0 + OL3 for RNA + ff19SB
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.ff19SB
Reading force field modification type file (frcmod)
Reading title:
ff19SB AA-specific backbone CMAPs for protein 07/25/2019
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/amino19.lib
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/aminoct12.lib
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/aminont12.lib
----- Source: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.water.opc3
----- Source of /home/alex/miniconda3/envs/metalflare-dev/dat/leap/cmd/leaprc.water.opc3 done
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/atomic_ions.lib
Loading library: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/lib/solvents.lib
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.opc3
Reading force field modification type file (frcmod)
Reading title:
OPC3 Water Model (Izadi and Onufriev,  145, 074501, 2016)
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.ionslm_126_opc3
Reading force field modification type file (frcmod)
Reading title:
Li/Merz ion parameters of atomic ions for the OPC3 water model (12-6 set)
Loading parameters: /home/alex/miniconda3/envs/metalflare-dev/dat/leap/parm/frcmod.ionslm_126_opc3
Reading force field modification type file (frcmod)
Reading title:
Li/Merz ion parameters of atomic ions for the OPC3 water model (12-6 set)
Loading parameters: ../../../methods/03-tleap/cro/frcmod.xFPchromophores.2022
Reading force field modification type file (frcmod)
Reading title:
frcmod file for fluorescent protein chromophores. Intended for use with ff14SB, ff19SB and related force fields. Parameters based on parm10.dat, gaff.dat, and frcmod.ff14SB. Publication by Breyfogle, Blood, Rosnik, and Krueger in preparation.
Loading library: ../../../methods/03-tleap/cro/xFPchromophores.lib.2022
Loading PDB file: ../structures/protein/1JC0-final.pdb
  total atoms in file: 3729
  Leap added 14 missing atoms according to residue templates:
       14 H / lone pairs
Adding 29 counter ions to "mol" using 1A grid
Grid extends from solute vdw + 1.47  to  7.45
Resolution:      1.00 Angstrom.
Calculating grid charges
Placed Na+ in mol at (16.73, -1.20, -2.08).
Placed Na+ in mol at (-5.27, 21.80, -21.08).
Placed Na+ in mol at (-15.27, -3.20, 14.92).
Placed Na+ in mol at (15.73, 9.80, -15.08).
Placed Na+ in mol at (9.73, -0.20, 18.92).
Placed Na+ in mol at (-11.27, 15.80, -19.08).
Placed Na+ in mol at (4.73, -20.20, -5.08).
Placed Na+ in mol at (-17.27, -0.20, -6.08).
Placed Na+ in mol at (-5.27, 18.80, -26.08).
Placed Na+ in mol at (2.73, 18.80, -10.08).
Placed Na+ in mol at (5.73, -19.20, 15.92).
Placed Na+ in mol at (-2.27, -16.20, -12.08).
Placed Na+ in mol at (-8.27, -21.20, -3.08).
Placed Na+ in mol at (7.73, 8.80, -21.08).
Placed Na+ in mol at (-13.27, -5.20, 21.92).
Placed Na+ in mol at (15.73, -2.20, 2.92).
Placed Na+ in mol at (19.73, -5.20, 1.92).
Placed Na+ in mol at (13.73, 20.80, -14.08).
Placed Na+ in mol at (-11.27, -10.20, -10.08).
Placed Na+ in mol at (-11.27, 21.80, -3.08).
Placed Na+ in mol at (5.73, -22.20, 7.92).
Placed Na+ in mol at (6.73, 0.80, 25.92).
Placed Na+ in mol at (-8.27, -13.20, 15.92).
Placed Na+ in mol at (4.73, -14.20, -18.08).
Placed Na+ in mol at (-16.27, 11.80, -9.08).
Placed Na+ in mol at (14.73, -1.20, 18.92).
Placed Na+ in mol at (-3.27, -21.20, 0.92).
Placed Na+ in mol at (-13.27, 7.80, 8.92).
Placed Na+ in mol at (3.73, 14.80, 6.92).

Done adding ions.
Adding 21 counter ions to "mol" using 1A grid
Grid extends from solute vdw + 2.31  to  8.29
Resolution:      1.00 Angstrom.
Calculating grid charges
Placed Cl- in mol at (18.90, -1.04, 1.09).
Placed Cl- in mol at (-11.10, 10.96, 9.09).
Placed Cl- in mol at (11.90, -1.04, 22.09).
Placed Cl- in mol at (-18.10, 12.96, -5.91).
Placed Cl- in mol at (-7.10, 21.96, -24.91).
Placed Cl- in mol at (-6.10, 12.96, 13.09).
Placed Cl- in mol at (3.90, 21.96, -11.91).
Placed Cl- in mol at (-3.10, -17.04, 24.09).
Placed Cl- in mol at (-8.10, -10.04, -21.91).
Placed Cl- in mol at (17.90, -7.04, 5.09).
Placed Cl- in mol at (5.90, 5.96, -22.91).
Placed Cl- in mol at (6.90, 16.96, 6.09).
Placed Cl- in mol at (10.90, 13.96, 11.09).
Placed Cl- in mol at (-9.10, -17.04, 16.09).
Placed Cl- in mol at (1.90, -16.04, -15.91).
Placed Cl- in mol at (-8.10, -21.04, -6.91).
Placed Cl- in mol at (-2.10, 0.96, 26.09).
Placed Cl- in mol at (6.90, -24.04, 11.09).
Placed Cl- in mol at (-13.10, 22.96, 0.09).
Placed Cl- in mol at (-14.10, -12.04, -7.91).
Placed Cl- in mol at (-2.10, -23.04, 4.09).

Done adding ions.
  Solute vdw bounding box:              42.324 51.612 56.867
  Total bounding box for atom centers:  62.324 71.612 76.867
  Solvent unit box:                     18.682 18.750 18.542
  Total vdw box size:                   65.595 74.511 79.756 angstroms.
  Volume: 389813.358 A^3 
  Total mass 192775.438 amu,  Density 0.821 g/cc
  Added 9140 residues.
Writing pdb file: /tmp/tmpc1hj2m37.pdb
   printing CRYST1 record to PDB file with box info

/home/alex/miniconda3/envs/metalflare-dev/bin/teLeap: Warning!
 Converting N-terminal residue name to PDB format: NMET -> MET

/home/alex/miniconda3/envs/metalflare-dev/bin/teLeap: Warning!
 Converting C-terminal residue name to PDB format: CGLY -> GLY
Checking Unit.
Building topology.
Building atom parameters.
Building bond parameters.
Building angle parameters.
Building proper torsion parameters.
Building improper torsion parameters.
 total 731 improper torsions applied
Building H-Bond parameters.
Incorporating Non-Bonded adjustments.
Not Marking per-residue atom chain types.
Marking per-residue atom chain types.
  (Residues lacking connect0/connect1 - 
   these don't have chain types marked:

	res	total affected

	CGLY	1
	NMET	1
	WAT	9198
  )
 (no restraints)
Total unperturbed charge:  -0.000000
Total perturbed charge:    -0.000000
	Quit

Exiting LEaP: Errors = 0; Warnings = 2; Notes = 0.

2024-05-21 10:19:37.975-04:00 | INFO     | metalflare.simulation.amber.tleap:parse_tleap_log:116 - Parsing tleap log
